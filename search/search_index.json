{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Ray \u8ba1\u7b97\u5de2\u5feb\u901f\u90e8\u7f72 \u514d\u8d23\u58f0\u660e\uff1a \u672c\u670d\u52a1\u7531\u7b2c\u4e09\u65b9\u63d0\u4f9b\uff0c\u6211\u4eec\u5c3d\u529b\u786e\u4fdd\u5176\u5b89\u5168\u6027\u3001\u51c6\u786e\u6027\u548c\u53ef\u9760\u6027\uff0c\u4f46\u65e0\u6cd5\u4fdd\u8bc1\u5176\u5b8c\u5168\u514d\u4e8e\u6545\u969c\u3001\u4e2d\u65ad\u3001\u9519\u8bef\u6216\u653b\u51fb\u3002\u56e0\u6b64\uff0c\u672c\u516c\u53f8\u5728\u6b64\u58f0\u660e\uff1a\u5bf9\u4e8e\u672c\u670d\u52a1\u7684\u5185\u5bb9\u3001\u51c6\u786e\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u9760\u6027\u3001\u9002\u7528\u6027\u4ee5\u53ca\u53ca\u65f6\u6027\u4e0d\u4f5c\u4efb\u4f55\u9648\u8ff0\u3001\u4fdd\u8bc1\u6216\u627f\u8bfa\uff0c\u4e0d\u5bf9\u60a8\u4f7f\u7528\u672c\u670d\u52a1\u6240\u4ea7\u751f\u7684\u4efb\u4f55\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u635f\u5931\u6216\u635f\u5bb3\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\uff1b\u5bf9\u4e8e\u60a8\u901a\u8fc7\u672c\u670d\u52a1\u8bbf\u95ee\u7684\u7b2c\u4e09\u65b9\u7f51\u7ad9\u3001\u5e94\u7528\u7a0b\u5e8f\u3001\u4ea7\u54c1\u548c\u670d\u52a1\uff0c\u4e0d\u5bf9\u5176\u5185\u5bb9\u3001\u51c6\u786e\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u9760\u6027\u3001\u9002\u7528\u6027\u4ee5\u53ca\u53ca\u65f6\u6027\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\uff0c\u60a8\u5e94\u81ea\u884c\u627f\u62c5\u4f7f\u7528\u540e\u679c\u4ea7\u751f\u7684\u98ce\u9669\u548c\u8d23\u4efb\uff1b\u5bf9\u4e8e\u56e0\u60a8\u4f7f\u7528\u672c\u670d\u52a1\u800c\u4ea7\u751f\u7684\u4efb\u4f55\u635f\u5931\u3001\u635f\u5bb3\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u76f4\u63a5\u635f\u5931\u3001\u95f4\u63a5\u635f\u5931\u3001\u5229\u6da6\u635f\u5931\u3001\u5546\u8a89\u635f\u5931\u3001\u6570\u636e\u635f\u5931\u6216\u5176\u4ed6\u7ecf\u6d4e\u635f\u5931\uff0c\u4e0d\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\uff0c\u5373\u4f7f\u672c\u516c\u53f8\u4e8b\u5148\u5df2\u88ab\u544a\u77e5\u53ef\u80fd\u5b58\u5728\u6b64\u7c7b\u635f\u5931\u6216\u635f\u5bb3\u7684\u53ef\u80fd\u6027\uff1b\u6211\u4eec\u4fdd\u7559\u4e0d\u65f6\u4fee\u6539\u672c\u58f0\u660e\u7684\u6743\u5229\uff0c\u56e0\u6b64\u8bf7\u60a8\u5728\u4f7f\u7528\u672c\u670d\u52a1\u524d\u5b9a\u671f\u68c0\u67e5\u672c\u58f0\u660e\u3002\u5982\u679c\u60a8\u5bf9\u672c\u58f0\u660e\u6216\u672c\u670d\u52a1\u5b58\u5728\u4efb\u4f55\u95ee\u9898\u6216\u7591\u95ee\uff0c\u8bf7\u8054\u7cfb\u6211\u4eec\u3002 \u6982\u8ff0 Ray \u662f\u4e00\u4e2a\u652f\u6301\u6a21\u578b\u8bad\u7ec3\u3001\u6d4b\u8bd5\u4ee5\u53ca\u90e8\u7f72\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u7531\u52a0\u5dde\u5927\u5b66\u4f2f\u514b\u5229\u5206\u6821\u7684 RISELab \u5f00\u53d1\u3002 \u5b83\u65e8\u5728\u7b80\u5316\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u3001\u5f3a\u5316\u5b66\u4e60\u548c\u5206\u5e03\u5f0f\u8ba1\u7b97\u4efb\u52a1\u7684\u5f00\u53d1\u4e0e\u90e8\u7f72\u3002 Ray \u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u63d0\u4f9b\u9ad8\u6027\u80fd\u3001\u7075\u6d3b\u6027\u548c\u6613\u7528\u6027\uff0c\u4f7f\u5f00\u53d1\u8005\u80fd\u591f\u8f7b\u677e\u6784\u5efa\u548c\u6269\u5c55\u590d\u6742\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u65e0\u8bba\u662f\u5904\u7406\u6d77\u91cf\u6570\u636e\u3001\u8bad\u7ec3\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\uff0c\u8fd8\u662f\u8fd0\u884c\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\uff0cRay \u90fd\u80fd\u63d0\u4f9b\u5f3a\u5927\u7684\u652f\u6301\u3002 \u524d\u63d0\u6761\u4ef6 \u90e8\u7f72Ray\u793e\u533a\u7248\u670d\u52a1\u5b9e\u4f8b\uff0c\u9700\u8981\u5bf9\u90e8\u5206\u963f\u91cc\u4e91\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\u548c\u521b\u5efa\u64cd\u4f5c\u3002\u56e0\u6b64\u60a8\u7684\u8d26\u53f7\u9700\u8981\u5305\u542b\u5982\u4e0b\u8d44\u6e90\u7684\u6743\u9650\u3002 \u8bf4\u660e \uff1a\u5f53\u60a8\u7684\u8d26\u53f7\u662fRAM\u8d26\u53f7\u65f6\uff0c\u624d\u9700\u8981\u6dfb\u52a0\u6b64\u6743\u9650\u3002 \u6743\u9650\u7b56\u7565\u540d\u79f0 \u5907\u6ce8 AliyunCSFullAccess \u7ba1\u7406\u5bb9\u5668\u670d\u52a1\uff08CS\uff09\u7684\u6743\u9650 AliyunECSFullAccess \u7ba1\u7406\u4e91\u670d\u52a1\u5668\u670d\u52a1\uff08ECS\uff09\u7684\u6743\u9650 AliyunVPCFullAccess \u7ba1\u7406\u4e13\u6709\u7f51\u7edc\uff08VPC\uff09\u7684\u6743\u9650 AliyunROSFullAccess \u7ba1\u7406\u8d44\u6e90\u7f16\u6392\u670d\u52a1\uff08ROS\uff09\u7684\u6743\u9650 AliyunComputeNestUserFullAccess \u7ba1\u7406\u8ba1\u7b97\u5de2\u670d\u52a1\uff08ComputeNest\uff09\u7684\u7528\u6237\u4fa7\u6743\u9650 \u8ba1\u8d39\u8bf4\u660e Ray\u793e\u533a\u7248\u5728\u8ba1\u7b97\u5de2\u90e8\u7f72\u7684\u8d39\u7528\u4e3b\u8981\u6d89\u53ca\uff1a \u6240\u9009Worker\u8282\u70b9\u7684vCPU\u4e0e\u5185\u5b58\u89c4\u683c \u7cfb\u7edf\u76d8\u7c7b\u578b\u53ca\u5bb9\u91cf \u516c\u7f51\u5e26\u5bbd \u90e8\u7f72\u6d41\u7a0b \u70b9\u51fb Ray\u4e00\u952e\u90e8\u7f72 \u94fe\u63a5\uff0c \u8fdb\u5165\u521b\u5efaRay\u96c6\u7fa4\u7684\u9875\u9762\u3002\u5982\u6ca1\u6709\u963f\u91cc\u4e91\u8d26\u53f7\u9700\u8981\u5148\u6ce8\u518c\u8d26\u53f7\u54e6\u3002 \u521b\u5efaRay\u96c6\u7fa4\u65f6\uff0c\u9996\u5148\u9009\u62e9\u65b0\u5efaACK\u96c6\u7fa4\u3002\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0\u5c06\u4f5c\u4e3a\u8fd0\u884cRay\u5e73\u53f0\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5c06\u5728\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u65f6\u4f7f\u7528\u3002 \u4e3a\u4fdd\u969cRay\u7684\u6d41\u7545\u8fd0\u884c\uff0cWorker\u8282\u70b9\u5efa\u8bae\u9009\u62e9 8vCpu 16GiB \u4ee5\u4e0a\u7684\u89c4\u683c\u3002\u7136\u540e\u586b\u5199\u5b9e\u4f8b\u5bc6\u7801\u3002 \u6a21\u578b\u90e8\u7f72\u57fa\u672c\u90fd\u6709Gpu\u9700\u6c42\uff0c\u5982\u679c\u9700\u8981Gpu\uff0c\u8bf7\u5728\u6b64\u6b65\u9009\u62e9\u6709Gpu\u7684\u89c4\u683c\u3002 \u672c\u6587\u6863\u5728\u4e0b\u4e00\u8282\u6f14\u793a\u4e86\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002 \u9009\u62e9\u4efb\u610f\u4e00\u4e2a\u53ef\u7528\u533a\uff0c\u7136\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65\uff1a\u786e\u8ba4\u8ba2\u5355\u3002 \u786e\u8ba4\u4f9d\u8d56\u6743\u9650\u5df2\u6388\u6743\uff0c\u5982\u672a\u6388\u6743\uff0c\u8bf7\u70b9\u51fb\u6388\u6743\u3002\u7136\u540e\u70b9\u51fb \u7acb\u5373\u521b\u5efa \u70b9\u51fb \u53bb\u5217\u8868\u67e5\u770b \u8df3\u8f6c\u5230\u8ba1\u7b97\u5de2\u63a7\u5236\u53f0\u7684\u670d\u52a1\u5b9e\u4f8b\u754c\u9762\u540e\uff0c\u8bf7\u7b49\u5f85Ray\u96c6\u7fa4\u521b\u5efa\u5b8c\u6210\uff0c\u5927\u7ea6\u9700\u898110\u5206\u949f\u3002 \u521b\u5efaRay\u96c6\u7fa4\u5b8c\u6210\u540e\uff0c\u70b9\u51fb Ray\u96c6\u7fa4\u540d\u79f0\u8fdb\u5165Ray\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u900f\u51fa\u7684web url\uff0c\u5373\u53ef\u8bbf\u95ee\u5230Ray\u96c6\u7fa4\u7684Ray Dashboard\u3002\u6b64\u65f6Ray\u96c6\u7fa4\u5df2\u7ecf\u6210\u529f\u8fd0\u884c\uff0c\u53ef\u901a\u8fc7 \u4e0b\u4e00\u8282\uff1a\u5feb\u901f\u4f53\u9a8c\u6a21\u578b\u90e8\u7f72 \u4e86\u89e3\u5982\u4f55\u5728\u96c6\u7fa4\u5185\u90e8\u7f72\u81ea\u5df1\u7684\u6a21\u578b\u3002 \u4f53\u9a8c\u6a21\u578b\u670d\u52a1\u90e8\u7f72 \u901a\u8fc7\u963f\u91cc\u4e91\u521b\u5efaRay\u96c6\u7fa4\u540e\uff0c\u672c\u8282\u5c55\u793a\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72\u4e00\u4e2a\u57fa\u4e8e Stable Diffusion \u7684\u6587\u672c\u5230\u56fe\u50cf\u751f\u6210\u670d\u52a1\u3002\u66f4\u591a\u793a\u4f8b\u53ef\u53c2\u8003[http://docs.ray.io/en/master/cluster/kubernetes/examples/stable-diffusion-rayservice.html#kuberay-stable-diffusion-rayservice-example)\u3002 \u786e\u8ba4\u96c6\u7fa4\u914d\u7f6e\u8db3\u591f \u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u96c6\u7fa4\u914d\u7f6e\u4e0d\u591f\u7528\uff0c\u4f1a\u5bfc\u81f4Stable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5931\u8d25\u3002 1. \u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002\u5b98\u65b9\u914d\u7f6e\u8981\u6c42\u5982\u4e0b\u56fe\u3002 \u96c6\u7fa4\u7ed1\u5b9a\u516c\u7f51IP(\u5982\u679c\u5df2\u7ed1\u5b9a\u53ef\u8df3\u8fc7) \u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u4e0d\u7ed1\u5b9a\u516c\u7f51IP\uff0c\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u62c9\u53d6\u6a21\u578b\u6587\u4ef6\u5931\u8d25\uff0c\u4e5f\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u65e0\u6cd5\u63d0\u4f9b\u5bf9\u5916\u670d\u52a1\u3002 1. \u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 2. \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 3. \u70b9\u51fb \u7ed1\u5b9a\u516c\u7f51IP \uff0c\u9009\u62e9\u5df2\u6709EIP\u3002\u5982\u679c\u6ca1\u6709EIP\uff0c\u70b9\u51fb\u521b\u5efaEIP\uff0c\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u8fd4\u56de\u8be5\u9875\u9762\u7ed1\u5b9a\u516c\u7f51IP\u3002 \u901a\u8fc7 kubectl \u8fde\u63a5 Kubernetes \u96c6\u7fa4 \u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u8fde\u63a5\u4fe1\u606f\uff0c\u67e5\u770bkubeconfig\u6587\u4ef6\u3002 \u70b9\u51fb \u5b89\u88c5\u548c\u8bbe\u7f6e kubectl \u3002\u8fd9\u662f\u4e00\u4e2a\u7528\u672c\u5730\u8bbe\u5907\u7ba1\u7406k8s\u96c6\u7fa4\u7684\u5de5\u5177\u3002\u53ef\u6839\u636e\u81ea\u8eab\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u5bf9\u5e94\u7684\u5b89\u88c5\u65b9\u5f0f\u3002 \u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6216\u81ea\u884c\u5728\u76ee\u5f55\u8def\u5f84\u4e0b\u624b\u52a8\u521b\u5efa$HOME/.kube/config\u6587\u4ef6\uff0c\u5e76\u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u3002 ```bash sudo mkdir -p $HOME/.kube sudo touch $HOME/.kube/config sudo chmod 777 $HOME/.kube/config vim $HOME/.kube/config \u90e8\u7f72\u6a21\u578b\u670d\u52a1 \u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u540e\uff0c\u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002--namespace={$\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0}\uff0c\u9700\u8981\u66ff\u6362\u4e3aRay\u96c6\u7fa4\u540d\u79f0\u3002 \u5982\u7b14\u8005\u7684Ray\u96c6\u7fa4\u540d\u79f0\u4e3akuberay-tdhrtg\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u6307\u4ee4\u66ff\u6362\u4e3asudo kubectl config set-context --current --namespace=kuberay-tdhrtg ```bash sudo kubectl config set-context --current --namespace={$Ray\u96c6\u7fa4\u540d\u79f0} \u5728\u672c\u5730\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002\u5bf9\u5e94 Ray\u5b98\u65b9\u6559\u7a0b \u4eceStep 3\u4e4b\u540e\u7684\u90e8\u5206\u3002 ``bash kubectl apply -f https://raw.githubusercontent.com/ray-project/kuberay/master/ray-operator/config/samples/ray-service.stable-diffusion.yaml kubectl get pods # Wait until the stable-diffusion is Running`. About 15 minutes are required for this to complete. kubectl describe rayservices.ray.io stable-diffusion # Forward the port of Serve kubectl port-forward svc/stable-diffusion-serve-svc 8000 # Download stable_diffusion_req.py curl -LO https://raw.githubusercontent.com/ray-project/serve_config_examples/master/stable_diffusion/stable_diffusion_req.py # Set your prompt in stable_diffusion_req.py . # Send a request to the Stable Diffusion model. python stable_diffusion_req.py ``` kubectl apply\u90e8\u7f72Stable Diffusion\u7ea6\u9700\u898115\u5206\u949f\u3002 3. \u8fd0\u884cpython stable_diffusion_req.py\u540e\uff0c\u6a21\u578b\u4f1a\u8f93\u51fa\u4e00\u5f20\u540d\u4e3aoutput.png\u7684\u56fe\u7247\u3002\u6b64\u65f6\uff0cStable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5b8c\u6210\u3002 output.png\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u66f4\u591a\u4fe1\u606f Ray\u5b98\u7f51 Ray\u5355\u673a\u7248\u5f00\u6e90\u5e93 Ray\u96c6\u7fa4\u7248\u5f00\u6e90\u5e93 Ray QuickStart\u5e2e\u52a9\u6587\u6863 Ray \u6a21\u578b\u670d\u52a1\u5316\u793a\u4f8b\u6587\u6863","title":"Ray \u8ba1\u7b97\u5de2\u5feb\u901f\u90e8\u7f72"},{"location":"#ray","text":"\u514d\u8d23\u58f0\u660e\uff1a \u672c\u670d\u52a1\u7531\u7b2c\u4e09\u65b9\u63d0\u4f9b\uff0c\u6211\u4eec\u5c3d\u529b\u786e\u4fdd\u5176\u5b89\u5168\u6027\u3001\u51c6\u786e\u6027\u548c\u53ef\u9760\u6027\uff0c\u4f46\u65e0\u6cd5\u4fdd\u8bc1\u5176\u5b8c\u5168\u514d\u4e8e\u6545\u969c\u3001\u4e2d\u65ad\u3001\u9519\u8bef\u6216\u653b\u51fb\u3002\u56e0\u6b64\uff0c\u672c\u516c\u53f8\u5728\u6b64\u58f0\u660e\uff1a\u5bf9\u4e8e\u672c\u670d\u52a1\u7684\u5185\u5bb9\u3001\u51c6\u786e\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u9760\u6027\u3001\u9002\u7528\u6027\u4ee5\u53ca\u53ca\u65f6\u6027\u4e0d\u4f5c\u4efb\u4f55\u9648\u8ff0\u3001\u4fdd\u8bc1\u6216\u627f\u8bfa\uff0c\u4e0d\u5bf9\u60a8\u4f7f\u7528\u672c\u670d\u52a1\u6240\u4ea7\u751f\u7684\u4efb\u4f55\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u635f\u5931\u6216\u635f\u5bb3\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\uff1b\u5bf9\u4e8e\u60a8\u901a\u8fc7\u672c\u670d\u52a1\u8bbf\u95ee\u7684\u7b2c\u4e09\u65b9\u7f51\u7ad9\u3001\u5e94\u7528\u7a0b\u5e8f\u3001\u4ea7\u54c1\u548c\u670d\u52a1\uff0c\u4e0d\u5bf9\u5176\u5185\u5bb9\u3001\u51c6\u786e\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u9760\u6027\u3001\u9002\u7528\u6027\u4ee5\u53ca\u53ca\u65f6\u6027\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\uff0c\u60a8\u5e94\u81ea\u884c\u627f\u62c5\u4f7f\u7528\u540e\u679c\u4ea7\u751f\u7684\u98ce\u9669\u548c\u8d23\u4efb\uff1b\u5bf9\u4e8e\u56e0\u60a8\u4f7f\u7528\u672c\u670d\u52a1\u800c\u4ea7\u751f\u7684\u4efb\u4f55\u635f\u5931\u3001\u635f\u5bb3\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u76f4\u63a5\u635f\u5931\u3001\u95f4\u63a5\u635f\u5931\u3001\u5229\u6da6\u635f\u5931\u3001\u5546\u8a89\u635f\u5931\u3001\u6570\u636e\u635f\u5931\u6216\u5176\u4ed6\u7ecf\u6d4e\u635f\u5931\uff0c\u4e0d\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\uff0c\u5373\u4f7f\u672c\u516c\u53f8\u4e8b\u5148\u5df2\u88ab\u544a\u77e5\u53ef\u80fd\u5b58\u5728\u6b64\u7c7b\u635f\u5931\u6216\u635f\u5bb3\u7684\u53ef\u80fd\u6027\uff1b\u6211\u4eec\u4fdd\u7559\u4e0d\u65f6\u4fee\u6539\u672c\u58f0\u660e\u7684\u6743\u5229\uff0c\u56e0\u6b64\u8bf7\u60a8\u5728\u4f7f\u7528\u672c\u670d\u52a1\u524d\u5b9a\u671f\u68c0\u67e5\u672c\u58f0\u660e\u3002\u5982\u679c\u60a8\u5bf9\u672c\u58f0\u660e\u6216\u672c\u670d\u52a1\u5b58\u5728\u4efb\u4f55\u95ee\u9898\u6216\u7591\u95ee\uff0c\u8bf7\u8054\u7cfb\u6211\u4eec\u3002","title":"Ray \u8ba1\u7b97\u5de2\u5feb\u901f\u90e8\u7f72"},{"location":"#_1","text":"Ray \u662f\u4e00\u4e2a\u652f\u6301\u6a21\u578b\u8bad\u7ec3\u3001\u6d4b\u8bd5\u4ee5\u53ca\u90e8\u7f72\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u7531\u52a0\u5dde\u5927\u5b66\u4f2f\u514b\u5229\u5206\u6821\u7684 RISELab \u5f00\u53d1\u3002 \u5b83\u65e8\u5728\u7b80\u5316\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u3001\u5f3a\u5316\u5b66\u4e60\u548c\u5206\u5e03\u5f0f\u8ba1\u7b97\u4efb\u52a1\u7684\u5f00\u53d1\u4e0e\u90e8\u7f72\u3002 Ray \u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u63d0\u4f9b\u9ad8\u6027\u80fd\u3001\u7075\u6d3b\u6027\u548c\u6613\u7528\u6027\uff0c\u4f7f\u5f00\u53d1\u8005\u80fd\u591f\u8f7b\u677e\u6784\u5efa\u548c\u6269\u5c55\u590d\u6742\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u65e0\u8bba\u662f\u5904\u7406\u6d77\u91cf\u6570\u636e\u3001\u8bad\u7ec3\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\uff0c\u8fd8\u662f\u8fd0\u884c\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\uff0cRay \u90fd\u80fd\u63d0\u4f9b\u5f3a\u5927\u7684\u652f\u6301\u3002","title":"\u6982\u8ff0"},{"location":"#_2","text":"\u90e8\u7f72Ray\u793e\u533a\u7248\u670d\u52a1\u5b9e\u4f8b\uff0c\u9700\u8981\u5bf9\u90e8\u5206\u963f\u91cc\u4e91\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\u548c\u521b\u5efa\u64cd\u4f5c\u3002\u56e0\u6b64\u60a8\u7684\u8d26\u53f7\u9700\u8981\u5305\u542b\u5982\u4e0b\u8d44\u6e90\u7684\u6743\u9650\u3002 \u8bf4\u660e \uff1a\u5f53\u60a8\u7684\u8d26\u53f7\u662fRAM\u8d26\u53f7\u65f6\uff0c\u624d\u9700\u8981\u6dfb\u52a0\u6b64\u6743\u9650\u3002 \u6743\u9650\u7b56\u7565\u540d\u79f0 \u5907\u6ce8 AliyunCSFullAccess \u7ba1\u7406\u5bb9\u5668\u670d\u52a1\uff08CS\uff09\u7684\u6743\u9650 AliyunECSFullAccess \u7ba1\u7406\u4e91\u670d\u52a1\u5668\u670d\u52a1\uff08ECS\uff09\u7684\u6743\u9650 AliyunVPCFullAccess \u7ba1\u7406\u4e13\u6709\u7f51\u7edc\uff08VPC\uff09\u7684\u6743\u9650 AliyunROSFullAccess \u7ba1\u7406\u8d44\u6e90\u7f16\u6392\u670d\u52a1\uff08ROS\uff09\u7684\u6743\u9650 AliyunComputeNestUserFullAccess \u7ba1\u7406\u8ba1\u7b97\u5de2\u670d\u52a1\uff08ComputeNest\uff09\u7684\u7528\u6237\u4fa7\u6743\u9650","title":"\u524d\u63d0\u6761\u4ef6"},{"location":"#_3","text":"Ray\u793e\u533a\u7248\u5728\u8ba1\u7b97\u5de2\u90e8\u7f72\u7684\u8d39\u7528\u4e3b\u8981\u6d89\u53ca\uff1a \u6240\u9009Worker\u8282\u70b9\u7684vCPU\u4e0e\u5185\u5b58\u89c4\u683c \u7cfb\u7edf\u76d8\u7c7b\u578b\u53ca\u5bb9\u91cf \u516c\u7f51\u5e26\u5bbd","title":"\u8ba1\u8d39\u8bf4\u660e"},{"location":"#_4","text":"\u70b9\u51fb Ray\u4e00\u952e\u90e8\u7f72 \u94fe\u63a5\uff0c \u8fdb\u5165\u521b\u5efaRay\u96c6\u7fa4\u7684\u9875\u9762\u3002\u5982\u6ca1\u6709\u963f\u91cc\u4e91\u8d26\u53f7\u9700\u8981\u5148\u6ce8\u518c\u8d26\u53f7\u54e6\u3002 \u521b\u5efaRay\u96c6\u7fa4\u65f6\uff0c\u9996\u5148\u9009\u62e9\u65b0\u5efaACK\u96c6\u7fa4\u3002\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0\u5c06\u4f5c\u4e3a\u8fd0\u884cRay\u5e73\u53f0\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5c06\u5728\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u65f6\u4f7f\u7528\u3002 \u4e3a\u4fdd\u969cRay\u7684\u6d41\u7545\u8fd0\u884c\uff0cWorker\u8282\u70b9\u5efa\u8bae\u9009\u62e9 8vCpu 16GiB \u4ee5\u4e0a\u7684\u89c4\u683c\u3002\u7136\u540e\u586b\u5199\u5b9e\u4f8b\u5bc6\u7801\u3002 \u6a21\u578b\u90e8\u7f72\u57fa\u672c\u90fd\u6709Gpu\u9700\u6c42\uff0c\u5982\u679c\u9700\u8981Gpu\uff0c\u8bf7\u5728\u6b64\u6b65\u9009\u62e9\u6709Gpu\u7684\u89c4\u683c\u3002 \u672c\u6587\u6863\u5728\u4e0b\u4e00\u8282\u6f14\u793a\u4e86\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002 \u9009\u62e9\u4efb\u610f\u4e00\u4e2a\u53ef\u7528\u533a\uff0c\u7136\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65\uff1a\u786e\u8ba4\u8ba2\u5355\u3002 \u786e\u8ba4\u4f9d\u8d56\u6743\u9650\u5df2\u6388\u6743\uff0c\u5982\u672a\u6388\u6743\uff0c\u8bf7\u70b9\u51fb\u6388\u6743\u3002\u7136\u540e\u70b9\u51fb \u7acb\u5373\u521b\u5efa \u70b9\u51fb \u53bb\u5217\u8868\u67e5\u770b \u8df3\u8f6c\u5230\u8ba1\u7b97\u5de2\u63a7\u5236\u53f0\u7684\u670d\u52a1\u5b9e\u4f8b\u754c\u9762\u540e\uff0c\u8bf7\u7b49\u5f85Ray\u96c6\u7fa4\u521b\u5efa\u5b8c\u6210\uff0c\u5927\u7ea6\u9700\u898110\u5206\u949f\u3002 \u521b\u5efaRay\u96c6\u7fa4\u5b8c\u6210\u540e\uff0c\u70b9\u51fb Ray\u96c6\u7fa4\u540d\u79f0\u8fdb\u5165Ray\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u900f\u51fa\u7684web url\uff0c\u5373\u53ef\u8bbf\u95ee\u5230Ray\u96c6\u7fa4\u7684Ray Dashboard\u3002\u6b64\u65f6Ray\u96c6\u7fa4\u5df2\u7ecf\u6210\u529f\u8fd0\u884c\uff0c\u53ef\u901a\u8fc7 \u4e0b\u4e00\u8282\uff1a\u5feb\u901f\u4f53\u9a8c\u6a21\u578b\u90e8\u7f72 \u4e86\u89e3\u5982\u4f55\u5728\u96c6\u7fa4\u5185\u90e8\u7f72\u81ea\u5df1\u7684\u6a21\u578b\u3002","title":"\u90e8\u7f72\u6d41\u7a0b"},{"location":"#_5","text":"\u901a\u8fc7\u963f\u91cc\u4e91\u521b\u5efaRay\u96c6\u7fa4\u540e\uff0c\u672c\u8282\u5c55\u793a\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72\u4e00\u4e2a\u57fa\u4e8e Stable Diffusion \u7684\u6587\u672c\u5230\u56fe\u50cf\u751f\u6210\u670d\u52a1\u3002\u66f4\u591a\u793a\u4f8b\u53ef\u53c2\u8003[http://docs.ray.io/en/master/cluster/kubernetes/examples/stable-diffusion-rayservice.html#kuberay-stable-diffusion-rayservice-example)\u3002","title":"\u4f53\u9a8c\u6a21\u578b\u670d\u52a1\u90e8\u7f72"},{"location":"#_6","text":"\u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u96c6\u7fa4\u914d\u7f6e\u4e0d\u591f\u7528\uff0c\u4f1a\u5bfc\u81f4Stable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5931\u8d25\u3002 1. \u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002\u5b98\u65b9\u914d\u7f6e\u8981\u6c42\u5982\u4e0b\u56fe\u3002","title":"\u786e\u8ba4\u96c6\u7fa4\u914d\u7f6e\u8db3\u591f"},{"location":"#ip","text":"\u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u4e0d\u7ed1\u5b9a\u516c\u7f51IP\uff0c\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u62c9\u53d6\u6a21\u578b\u6587\u4ef6\u5931\u8d25\uff0c\u4e5f\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u65e0\u6cd5\u63d0\u4f9b\u5bf9\u5916\u670d\u52a1\u3002 1. \u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 2. \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 3. \u70b9\u51fb \u7ed1\u5b9a\u516c\u7f51IP \uff0c\u9009\u62e9\u5df2\u6709EIP\u3002\u5982\u679c\u6ca1\u6709EIP\uff0c\u70b9\u51fb\u521b\u5efaEIP\uff0c\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u8fd4\u56de\u8be5\u9875\u9762\u7ed1\u5b9a\u516c\u7f51IP\u3002","title":"\u96c6\u7fa4\u7ed1\u5b9a\u516c\u7f51IP(\u5982\u679c\u5df2\u7ed1\u5b9a\u53ef\u8df3\u8fc7)"},{"location":"#kubectl-kubernetes","text":"\u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u8fde\u63a5\u4fe1\u606f\uff0c\u67e5\u770bkubeconfig\u6587\u4ef6\u3002 \u70b9\u51fb \u5b89\u88c5\u548c\u8bbe\u7f6e kubectl \u3002\u8fd9\u662f\u4e00\u4e2a\u7528\u672c\u5730\u8bbe\u5907\u7ba1\u7406k8s\u96c6\u7fa4\u7684\u5de5\u5177\u3002\u53ef\u6839\u636e\u81ea\u8eab\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u5bf9\u5e94\u7684\u5b89\u88c5\u65b9\u5f0f\u3002 \u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6216\u81ea\u884c\u5728\u76ee\u5f55\u8def\u5f84\u4e0b\u624b\u52a8\u521b\u5efa$HOME/.kube/config\u6587\u4ef6\uff0c\u5e76\u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u3002 ```bash sudo mkdir -p $HOME/.kube sudo touch $HOME/.kube/config sudo chmod 777 $HOME/.kube/config vim $HOME/.kube/config","title":"\u901a\u8fc7 kubectl \u8fde\u63a5 Kubernetes \u96c6\u7fa4"},{"location":"#_7","text":"\u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u540e\uff0c\u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002--namespace={$\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0}\uff0c\u9700\u8981\u66ff\u6362\u4e3aRay\u96c6\u7fa4\u540d\u79f0\u3002 \u5982\u7b14\u8005\u7684Ray\u96c6\u7fa4\u540d\u79f0\u4e3akuberay-tdhrtg\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u6307\u4ee4\u66ff\u6362\u4e3asudo kubectl config set-context --current --namespace=kuberay-tdhrtg ```bash sudo kubectl config set-context --current --namespace={$Ray\u96c6\u7fa4\u540d\u79f0} \u5728\u672c\u5730\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002\u5bf9\u5e94 Ray\u5b98\u65b9\u6559\u7a0b \u4eceStep 3\u4e4b\u540e\u7684\u90e8\u5206\u3002 ``bash kubectl apply -f https://raw.githubusercontent.com/ray-project/kuberay/master/ray-operator/config/samples/ray-service.stable-diffusion.yaml kubectl get pods # Wait until the stable-diffusion is Running`. About 15 minutes are required for this to complete. kubectl describe rayservices.ray.io stable-diffusion # Forward the port of Serve kubectl port-forward svc/stable-diffusion-serve-svc 8000 # Download stable_diffusion_req.py curl -LO https://raw.githubusercontent.com/ray-project/serve_config_examples/master/stable_diffusion/stable_diffusion_req.py # Set your prompt in stable_diffusion_req.py . # Send a request to the Stable Diffusion model. python stable_diffusion_req.py ``` kubectl apply\u90e8\u7f72Stable Diffusion\u7ea6\u9700\u898115\u5206\u949f\u3002 3. \u8fd0\u884cpython stable_diffusion_req.py\u540e\uff0c\u6a21\u578b\u4f1a\u8f93\u51fa\u4e00\u5f20\u540d\u4e3aoutput.png\u7684\u56fe\u7247\u3002\u6b64\u65f6\uff0cStable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5b8c\u6210\u3002 output.png\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"\u90e8\u7f72\u6a21\u578b\u670d\u52a1"},{"location":"#_8","text":"Ray\u5b98\u7f51 Ray\u5355\u673a\u7248\u5f00\u6e90\u5e93 Ray\u96c6\u7fa4\u7248\u5f00\u6e90\u5e93 Ray QuickStart\u5e2e\u52a9\u6587\u6863 Ray \u6a21\u578b\u670d\u52a1\u5316\u793a\u4f8b\u6587\u6863","title":"\u66f4\u591a\u4fe1\u606f"},{"location":"index-en/","text":"Rapid deployment of the Ray computing nest Overview Ray is an open-source platform that supports model training, testing, and deployment, developed by RISELab at the University of California, Berkeley. It is designed to simplify the development and deployment of large-scale machine learning, reinforcement learning, and distributed computing tasks. Ray is designed to provide high performance, flexibility, and ease of use, enabling developers to easily build and scale complex distributed applications. Whether you're processing massive amounts of data, training deep learning models, or running reinforcement learning algorithms, Ray provides powerful support. Prerequisites To deploy a Ray Community Edition service instance, you need to access and create some Alibaba Cloud resources. Therefore, your account must contain permissions for the following resources. Note : This permission is required only when your account is a RAM account. Permission policy name Remarks AliyunCSFullAccess Manage permissions for Container Service (CS) AliyunECSFullAccess Permissions to manage ECS AliyunVPCFullAccess Permissions for managing VPC networks AliyunROSFullAccess Manage permissions for Resource Orchestration Services (ROS) AliyunComputeNestUserFullAccess Manage user-side permissions for the compute nest service (ComputeNest) Billing instructions the cost of ray community edition deployment in computing nest mainly involves: vCPU and memory specifications of the selected Worker node System disk type and capacity Internet bandwidth Deployment process Click the Ray one-click deployment link, Go to the Create Ray Cluster page. If there is no Aliyun account, you need to register your account first. When creating a Ray cluster, first select Create ACK Cluster. The service instance name will be used as the namespace of the running Ray platform and will be used when the model service is deployed. To ensure the smooth operation of Ray, we recommend that you select a specification of 8vCpu 16GiB or more for the worker node. Then fill in the instance password. Model deployment basically requires Gpu. If you need Gpu, select the specification with Gpu in this step. The next section of this document demonstrates how to deploy the Stable Diffusion model service on a Ray cluster. recommend using the ecs.gn7i-c8g1.2xlarge and later specifications, the system disk size of the worker node recommend greater than 1024GB. Select any Availability Zone and click Next: Confirm Order. Confirm that the dependency permission is authorized. If not, click Authorize. Then click Create Now Click to go to list view After jumping to the service instance interface of the computing nest console, please wait for the creation of the Ray cluster to be completed, which takes about 10 minutes. After creating the Ray cluster, click the Ray cluster name to go to the Ray cluster details page. click the revealed web url to access the Ray Dashboard of the Ray cluster. At this point, the Ray cluster is running successfully, and you can learn how to deploy your own model in the cluster in the next section: Quickly experience model deployment. Experience model service deployment After creating a Ray cluster through Alibaba Cloud, this section shows how to deploy a text-to-image generation service based on the Stable Diffusion on the Ray cluster. More examples can be found in [http://docs.ray.io/en/master/cluster/kubernetes/examples/stable-diffusion-rayservice.html#kuberay-stable-diffusion-rayservice-example). Confirm that the cluster configuration is sufficient \u26a0\ufe0f Note: If the cluster configuration is not enough, it will cause the stable Diffusion model service deployment to fail. 1. Deploy the Stable Diffusion model service on the Ray cluster, recommend use the ecs.gn7i-c8g1.2xlarge and later specifications, and the system disk size of the worker node recommend 1024GB or more. The official configuration requirements are shown in the figure below. Bind a public IP address to the cluster (skip if bound) \u26a0Note: If the public network IP is not bound, the Ray cluster will fail to pull the model file and the Ray cluster will not be able to provide external services. 1. On the Service Instance Details page, click Resources to view the resource usage of the Ray cluster. 2. Find the k8s cluster and click the name to enter the k8s cluster details page. 3. Click Bind Public IP and select an existing EIP. If there is no EIP, click Create EIP. After the EIP is created, return to the page to bind the public IP. Connect to the Kubernetes cluster through the kubectl On the Service Instance Details page, click Resources to view the resource usage of the Ray cluster. Find the k8s cluster and click the name to enter the k8s cluster details page. Click Connection Info to view the kubeconfig file. Click Install and set up kubectl . This is a tool for managing k8s clusters with local devices. The corresponding installation method can be selected according to its own operating system. Run the following command on the local device or manually create the $HOME/.kube/config file in the directory path, and paste the contents of the kubeconfig file into the file. '''bash sudo mkdir -p $HOME/.kube sudo touch $HOME/.kube/config sudo chmod 777 $HOME/.kube/config vim $HOME/.kube/config Deploy model services After pasting the contents of the kubeconfig file into the file, execute the following command on the local device. -- namespace ={$ service instance name}. Replace with the name of the Ray cluster. For example, the name of the author's Ray cluster is kuberay-tdhrtg, so the following instruction is replaced by sudo kubectl config set-context-current-namespace = kuberay-tdhrtg sudo kubectl config set-context --current -- namespace ={ $Ray cluster name } 2 . Run the following commands locally. Corresponds to the section following [ Ray Official Tutorial ]( https://docs.ray.io/en/master/cluster/kubernetes/examples/stable-diffusion-rayservice.html ) from Step 3. ''' bash kubectl apply -f https://raw.githubusercontent.com/ray-project/kuberay/master/ray-operator/config/samples/ray-service.stable-diffusion.yaml kubectl get pods # Wait until the stable-diffusion is 'Running'. About 15 minutes are required for this to complete. kubectl describe rayservices.ray.io stable-diffusion # Forward the port of Serve kubectl port-forward svc/stable-diffusion-serve-svc 8000 # Download 'stable_diffusion_req.py' curl -LO https://raw.githubusercontent.com/ray-project/serve_config_examples/master/stable_diffusion/stable_diffusion_req.py # Set your 'prompt' in 'stable_diffusion_req.py'. # Send a request to the Stable Diffusion model. python stable_diffusion_req.py kubectl apply deploy Stable Diffusion takes about 15 minutes. After running python stable diffusion req.py, the model will output an image named output.png. At this point, the Stable Diffusion model service deployment is complete. output.png as shown below. More information Ray Ray standalone open source library Ray Cluster Edition Open Source Library Ray QuickStart help documentation Ray Model Servicing Sample Document","title":"Index en"},{"location":"index-opendoc/","text":"30\u5206\u949f\u62c9\u8d77Ray\u96c6\u7fa4\u5e76\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1 Ray \u5e73\u53f0\u7b80\u4ecb Ray \u662f\u4e00\u4e2a\u652f\u6301\u6a21\u578b\u8bad\u7ec3\u3001\u6d4b\u8bd5\u4ee5\u53ca\u90e8\u7f72\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u7531\u52a0\u5dde\u5927\u5b66\u4f2f\u514b\u5229\u5206\u6821\u7684 RISELab \u5f00\u53d1\u3002\u5b83\u65e8\u5728\u7b80\u5316\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u3001\u5f3a\u5316\u5b66\u4e60\u548c\u5206\u5e03\u5f0f\u8ba1\u7b97\u4efb\u52a1\u7684\u5f00\u53d1\u4e0e\u90e8\u7f72\u3002Ray \u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u63d0\u4f9b\u9ad8\u6027\u80fd\u3001\u7075\u6d3b\u6027\u548c\u6613\u7528\u6027\uff0c\u4f7f\u5f00\u53d1\u8005\u80fd\u591f\u8f7b\u677e\u6784\u5efa\u548c\u6269\u5c55\u590d\u6742\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u65e0\u8bba\u662f\u5904\u7406\u6d77\u91cf\u6570\u636e\u3001\u8bad\u7ec3\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\uff0c\u8fd8\u662f\u8fd0\u884c\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\uff0cRay \u90fd\u80fd\u63d0\u4f9b\u5f3a\u5927\u7684\u652f\u6301\u3002 Ray\u63d0\u4f9b\u4e86\u5927\u91cf\u7684 \u5e2e\u52a9\u6587\u6863 \uff0c\u5176\u4e2d\u5305\u542b\u8bb8\u591a\u793a\u4f8b\u548c\u6559\u7a0b\uff0c\u5e2e\u52a9\u7528\u6237\u5feb\u901f\u638c\u63e1\u5982\u4f55\u901a\u8fc7Ray\u8fdb\u884c\u6a21\u578b\u8bad\u7ec3\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002 \u8fd8\u63d0\u4f9b\u4e86\u5927\u91cf\u9002\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u4e2d\u7684 \u6a21\u578b\u670d\u52a1\u5316\u7684\u4f8b\u5b50 \uff0c\u6d89\u53ca\u5927\u8bed\u8a00\u6a21\u578b\uff0c\u5f3a\u5316\u5b66\u4e60\uff0c\u673a\u5668\u5b66\u4e60\u6a21\u578b, \u56fe\u50cf\u751f\u6210\uff08Stable Diffusion\uff09\uff0c\u56fe\u50cf\u5206\u7c7b\uff0c\u6587\u672c\u5206\u7c7b\u548c\u76ee\u6807\u68c0\u6d4b\u7b49\u4f17\u591a\u9886\u57df\u548c\u65b9\u5411\uff0c \u5e2e\u52a9\u6a21\u578b\u5f00\u53d1\u8005\u80fd\u591f\u5feb\u901f\u901a\u8fc7Ray\u6784\u5efa\u548c\u90e8\u7f72\u6a21\u578b\u670d\u52a1\u3002 Ray \u7684\u6838\u5fc3\u80fd\u529b 1. \u5206\u5e03\u5f0f\u8ba1\u7b97 \u5206\u5e03\u5f0f\u8bad\u7ec3 \uff1aRay \u63d0\u4f9b\u4e86\u5206\u5e03\u5f0f\u8bad\u7ec3\u7684\u80fd\u529b\uff0c\u652f\u6301\u591a\u673a\u591a\u5361\u7684\u6a21\u578b\u8bad\u7ec3\uff0c\u663e\u8457\u7f29\u77ed\u8bad\u7ec3\u65f6\u95f4\u3002 \u5e76\u884c\u4efb\u52a1\u6267\u884c \uff1aRay \u652f\u6301\u5c06\u4efb\u52a1\u5206\u89e3\u4e3a\u591a\u4e2a\u5b50\u4efb\u52a1\uff0c\u5e76\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u5e76\u884c\u6267\u884c\uff0c\u4ece\u800c\u9ad8\u6548\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u548c\u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1\u3002 \u52a8\u6001\u4efb\u52a1\u8c03\u5ea6 \uff1aRay \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7075\u6d3b\u7684\u4efb\u52a1\u8c03\u5ea6\u5668\uff0c\u53ef\u4ee5\u6839\u636e\u8d44\u6e90\u9700\u6c42\u52a8\u6001\u5206\u914d\u8ba1\u7b97\u8d44\u6e90\uff0c\u4f18\u5316\u4efb\u52a1\u6267\u884c\u6548\u7387\u3002 \u5bb9\u9519\u673a\u5236 \uff1a\u5185\u7f6e\u7684\u5bb9\u9519\u673a\u5236\u80fd\u591f\u5728\u8282\u70b9\u6545\u969c\u65f6\u81ea\u52a8\u6062\u590d\u4efb\u52a1\uff0c\u786e\u4fdd\u7cfb\u7edf\u7684\u9ad8\u53ef\u7528\u6027\u3002 2. \u6a21\u578b\u8bad\u7ec3\u548c\u6d4b\u8bd5 \u652f\u6301\u4e3b\u6d41\u673a\u5668\u5b66\u4e60\u6846\u67b6 \uff1aRay \u53ef\u4ee5\u4e0e TensorFlow\u3001PyTorch \u7b49\u4e3b\u6d41\u673a\u5668\u5b66\u4e60\u6846\u67b6\u65e0\u7f1d\u96c6\u6210\uff0c\u52a0\u901f\u6a21\u578b\u8bad\u7ec3\u548c\u63a8\u7406\u3002 \u652f\u6301\u5f3a\u5316\u5b66\u4e60 \uff1aRay \u96c6\u6210\u4e86 RLlib\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5f3a\u5316\u5b66\u4e60\u5e93\uff0c\u652f\u6301\u591a\u79cd\u7b97\u6cd5\uff08\u5982 DQN\u3001PPO\u3001A3C \u7b49\uff09\uff0c\u9002\u7528\u4e8e\u5404\u79cd\u5f3a\u5316\u5b66\u4e60\u573a\u666f\u3002 \u9ad8\u6548\u4eff\u771f\u73af\u5883 \uff1aRay \u53ef\u4ee5\u4e0e\u4eff\u771f\u73af\u5883\uff08\u5982 OpenAI Gym\uff09\u7ed3\u5408\uff0c\u5feb\u901f\u6784\u5efa\u548c\u6d4b\u8bd5\u5f3a\u5316\u5b66\u4e60\u6a21\u578b\u3002 \u8d85\u53c2\u6570\u8c03\u4f18 \uff1a\u901a\u8fc7 Ray Tune\uff08Ray \u7684\u8d85\u53c2\u6570\u4f18\u5316\u5e93\uff09\uff0c\u7528\u6237\u53ef\u4ee5\u9ad8\u6548\u5730\u8fdb\u884c\u8d85\u53c2\u6570\u641c\u7d22\uff0c\u627e\u5230\u6700\u4f18\u6a21\u578b\u914d\u7f6e\u3002 3. \u670d\u52a1\u7f16\u6392\u4e0e\u90e8\u7f72 Ray Serve \uff1aRay \u63d0\u4f9b\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u670d\u52a1\u7f16\u6392\u6846\u67b6\uff08Ray Serve\uff09\uff0c\u7528\u4e8e\u90e8\u7f72\u548c\u7ba1\u7406\u673a\u5668\u5b66\u4e60\u6a21\u578b\u548c\u670d\u52a1\u3002\u5b83\u652f\u6301\u591a\u6a21\u578b\u7ec4\u5408\u3001\u52a8\u6001\u6269\u5c55\u548c\u4f4e\u5ef6\u8fdf\u63a8\u7406\u3002 \u5b9e\u65f6\u63a8\u7406 \uff1aRay Serve \u80fd\u591f\u5904\u7406\u9ad8\u5e76\u53d1\u7684\u5b9e\u65f6\u63a8\u7406\u8bf7\u6c42\uff0c\u9002\u5408\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u6a21\u578b\u670d\u52a1\u5316\u3002 4. \u5927\u89c4\u6a21\u6570\u636e\u5904\u7406 Ray Data \uff1aRay \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5206\u5e03\u5f0f\u6570\u636e\u5904\u7406\u5e93\uff08Ray Data\uff09\uff0c\u7528\u4e8e\u9ad8\u6548\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u96c6\u3002\u5b83\u652f\u6301\u5e38\u89c1\u7684\u6570\u636e\u64cd\u4f5c\uff08\u5982\u8fc7\u6ee4\u3001\u6620\u5c04\u3001\u805a\u5408\u7b49\uff09\uff0c\u5e76\u80fd\u4e0e\u5176\u4ed6 Ray \u7ec4\u4ef6\u65e0\u7f1d\u96c6\u6210\u3002 \u4e0e\u5927\u6570\u636e\u751f\u6001\u517c\u5bb9 \uff1aRay \u53ef\u4ee5\u4e0e Apache Spark \u7b49\u5927\u6570\u636e\u5de5\u5177\u7ed3\u5408\u4f7f\u7528\uff0c\u8fdb\u4e00\u6b65\u6269\u5c55\u5176\u6570\u636e\u5904\u7406\u80fd\u529b\u3002 Ray \u7684\u90e8\u7f72\u65b9\u5f0f \u901a\u8fc7\u4ee5\u4e0a\u4ecb\u7ecd\u53ef\u4ee5\u770b\u51fa\uff0cRay \u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u4e14\u7075\u6d3b\u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\u5e73\u53f0\uff0c\u9002\u7528\u4e8e\u4ece\u673a\u5668\u5b66\u4e60\u5230\u79d1\u5b66\u8ba1\u7b97\u7684\u5e7f\u6cdb\u573a\u666f\u3002\u5b83\u7684\u9ad8\u6027\u80fd\u3001\u6613\u7528\u6027\u548c\u4e30\u5bcc\u7684\u751f\u6001\u7cfb\u7edf\u4f7f\u5176\u6210\u4e3a\u5f00\u53d1\u8005\u7684\u9996\u9009\u5de5\u5177\u4e4b\u4e00\u3002 \u90a3\u4e48\uff0c\u8be5\u5982\u4f55\u90e8\u7f72\u548c\u4f7f\u7528 Ray \u5462\uff1f \u672c\u5730\u5355\u673a\u90e8\u7f72 Ray\u652f\u6301\u5728\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u7684 \u672c\u5730\u90e8\u7f72 \uff0c\u4e14\u63d0\u4f9b\u4e86python\u3001Java\u3001C++\u4ee5\u53caDocker\u7b49\u60c5\u51b5\u4e0b\u7684\u5b89\u88c5\u65b9\u5f0f\u3002 \u672c\u5730\u96c6\u7fa4\u90e8\u7f72 \u524d\u63d0\u6761\u4ef6\uff1a \u7528\u6237\u5df2\u6709k8s\u96c6\u7fa4\u6216\u53ef\u81ea\u884c\u521b\u5efak8s\u96c6\u7fa4\u3002 \u7531\u4e8e\u5355\u673a\u573a\u666f\u4e0b\u6027\u80fd\u6709\u9650\uff0c\u96be\u4ee5\u652f\u6301\u751f\u4ea7\u573a\u666f\u4e0b\u7684\u6a21\u578b\u8bad\u7ec3\uff0cRay\u8fd8\u63d0\u4f9b\u4e86\u5f00\u6e90\u7684\u96c6\u7fa4\u7248\u672c\uff1a KubeRay \u3002 \u7528\u6237\u53ef\u6839\u636e RayCluster Quickstart \u6d41\u7a0b\u90e8\u7f72KubeRay\uff0c \u53ef\u6839\u636e RayJob Quickstart \u4f53\u9a8c\u5982\u4f55\u901a\u8fc7KubeRay\u7ba1\u7406\u4efb\u52a1\uff0c \u8fd8\u53ef\u6839\u636e RayService Quickstart \u4f53\u9a8c\u5982\u4f55\u901a\u8fc7KubeRay\u90e8\u7f72\u7528\u6237\u5e94\u7528\u3002 \u4ed3\u5e93\u4e2d\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u793a\u4f8b\u5e94\u7528\uff0c\u5e2e\u52a9\u7528\u6237\u5feb\u901f\u4e86\u89e3KubeRay\u4e0b\u7684\u6a21\u578b\u90e8\u7f72\u8fc7\u7a0b\u3002 \u963f\u91cc\u4e91\u4e00\u952e\u90e8\u7f72 \u524d\u63d0\u6761\u4ef6\uff1a \u5f00\u901a\u963f\u91cc\u4e91\u8d26\u53f7\u3002 \u963f\u91cc\u4e91\u8ba1\u7b97\u5de2\u63d0\u4f9b\u4e86Ray\u7684\u4e00\u952e\u90e8\u7f72\u670d\u52a1\uff0c\u7528\u6237\u65e0\u9700\u624b\u52a8\u642d\u5efaRay\u96c6\u7fa4\uff0c\u4ec5\u9700\u5728\u521b\u5efa\u5b9e\u4f8b\u540e\u7b49\u5f85\u7ea610\u5206\u949f\uff0c\u5373\u53ef\u4f53\u9a8cRay\u96c6\u7fa4\u7684\u5f3a\u5927\u80fd\u529b\u3002 \u90e8\u7f72\u6d41\u7a0b \u70b9\u51fb Ray\u4e00\u952e\u90e8\u7f72 \u94fe\u63a5\uff0c \u8fdb\u5165\u521b\u5efaRay\u96c6\u7fa4\u7684\u9875\u9762\u3002\u5982\u6ca1\u6709\u963f\u91cc\u4e91\u8d26\u53f7\u9700\u8981\u5148\u6ce8\u518c\u8d26\u53f7\u54e6\u3002 \u521b\u5efaRay\u96c6\u7fa4\u65f6\uff0c\u9996\u5148\u9009\u62e9\u65b0\u5efaACK\u96c6\u7fa4\u3002\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0\u5c06\u4f5c\u4e3a\u8fd0\u884cRay\u5e73\u53f0\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5c06\u5728\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u65f6\u4f7f\u7528\u3002 \u4e3a\u4fdd\u969cRay\u7684\u6d41\u7545\u8fd0\u884c\uff0cWorker\u8282\u70b9\u5efa\u8bae\u9009\u62e9 8vCpu 16GiB \u4ee5\u4e0a\u7684\u89c4\u683c\u3002\u7136\u540e\u586b\u5199\u5b9e\u4f8b\u5bc6\u7801\u3002 \u6a21\u578b\u90e8\u7f72\u57fa\u672c\u90fd\u6709Gpu\u9700\u6c42\uff0c\u5982\u679c\u9700\u8981Gpu\uff0c\u8bf7\u5728\u6b64\u6b65\u9009\u62e9\u6709Gpu\u7684\u89c4\u683c\u3002 \u672c\u6587\u6863\u5728\u4e0b\u4e00\u8282\u6f14\u793a\u4e86\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002 \u9009\u62e9\u4efb\u610f\u4e00\u4e2a\u53ef\u7528\u533a\uff0c\u7136\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65\uff1a\u786e\u8ba4\u8ba2\u5355\u3002 \u786e\u8ba4\u4f9d\u8d56\u6743\u9650\u5df2\u6388\u6743\uff0c\u5982\u672a\u6388\u6743\uff0c\u8bf7\u70b9\u51fb\u6388\u6743\u3002\u7136\u540e\u70b9\u51fb \u7acb\u5373\u521b\u5efa \u70b9\u51fb \u53bb\u5217\u8868\u67e5\u770b \u8df3\u8f6c\u5230\u8ba1\u7b97\u5de2\u63a7\u5236\u53f0\u7684\u670d\u52a1\u5b9e\u4f8b\u754c\u9762\u540e\uff0c\u8bf7\u7b49\u5f85Ray\u96c6\u7fa4\u521b\u5efa\u5b8c\u6210\uff0c\u5927\u7ea6\u9700\u898110\u5206\u949f\u3002 \u521b\u5efaRay\u96c6\u7fa4\u5b8c\u6210\u540e\uff0c\u70b9\u51fb Ray\u96c6\u7fa4\u540d\u79f0\u8fdb\u5165Ray\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u900f\u51fa\u7684web url\uff0c\u5373\u53ef\u8bbf\u95ee\u5230Ray\u96c6\u7fa4\u7684Ray Dashboard\u3002\u6b64\u65f6Ray\u96c6\u7fa4\u5df2\u7ecf\u6210\u529f\u8fd0\u884c\uff0c\u53ef\u901a\u8fc7 \u4e0b\u4e00\u8282\uff1a\u5feb\u901f\u4f53\u9a8c\u6a21\u578b\u90e8\u7f72 \u4e86\u89e3\u5982\u4f55\u5728\u96c6\u7fa4\u5185\u90e8\u7f72\u81ea\u5df1\u7684\u6a21\u578b\u3002 \u4f53\u9a8c\u6a21\u578b\u670d\u52a1\u90e8\u7f72 \u901a\u8fc7\u963f\u91cc\u4e91\u521b\u5efaRay\u96c6\u7fa4\u540e\uff0c\u672c\u8282\u5c55\u793a\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72\u4e00\u4e2a\u57fa\u4e8e Stable Diffusion \u7684\u6587\u672c\u5230\u56fe\u50cf\u751f\u6210\u670d\u52a1\u3002\u66f4\u591a\u793a\u4f8b\u53ef\u53c2\u8003[http://docs.ray.io/en/master/cluster/kubernetes/examples/stable-diffusion-rayservice.html#kuberay-stable-diffusion-rayservice-example)\u3002 \u786e\u8ba4\u96c6\u7fa4\u914d\u7f6e\u8db3\u591f \u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u96c6\u7fa4\u914d\u7f6e\u4e0d\u591f\u7528\uff0c\u4f1a\u5bfc\u81f4Stable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5931\u8d25\u3002 1. \u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002 \u96c6\u7fa4\u7ed1\u5b9a\u516c\u7f51IP(\u5982\u679c\u5df2\u7ed1\u5b9a\u53ef\u8df3\u8fc7) \u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u4e0d\u7ed1\u5b9a\u516c\u7f51IP\uff0c\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u62c9\u53d6\u6a21\u578b\u6587\u4ef6\u5931\u8d25\uff0c\u4e5f\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u65e0\u6cd5\u63d0\u4f9b\u5bf9\u5916\u670d\u52a1\u3002 1. \u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 2. \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 3. \u70b9\u51fb \u7ed1\u5b9a\u516c\u7f51IP \uff0c\u9009\u62e9\u5df2\u6709EIP\u3002\u5982\u679c\u6ca1\u6709EIP\uff0c\u70b9\u51fb\u521b\u5efaEIP\uff0c\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u8fd4\u56de\u8be5\u9875\u9762\u7ed1\u5b9a\u516c\u7f51IP\u3002 \u901a\u8fc7 kubectl \u8fde\u63a5 Kubernetes \u96c6\u7fa4 \u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u8fde\u63a5\u4fe1\u606f\uff0c\u67e5\u770bkubeconfig\u6587\u4ef6\u3002 \u70b9\u51fb \u5b89\u88c5\u548c\u8bbe\u7f6e kubectl \u3002\u8fd9\u662f\u4e00\u4e2a\u7528\u672c\u5730\u8bbe\u5907\u7ba1\u7406k8s\u96c6\u7fa4\u7684\u5de5\u5177\u3002\u53ef\u6839\u636e\u81ea\u8eab\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u5bf9\u5e94\u7684\u5b89\u88c5\u65b9\u5f0f\u3002 \u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6216\u81ea\u884c\u5728\u76ee\u5f55\u8def\u5f84\u4e0b\u624b\u52a8\u521b\u5efa$HOME/.kube/config\u6587\u4ef6\uff0c\u5e76\u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u3002 ```bash sudo mkdir -p $HOME/.kube sudo touch $HOME/.kube/config sudo chmod 777 $HOME/.kube/config vim $HOME/.kube/config \u90e8\u7f72\u6a21\u578b\u670d\u52a1 \u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u540e\uff0c\u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002--namespace={$\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0}\uff0c\u9700\u8981\u66ff\u6362\u4e3aRay\u96c6\u7fa4\u540d\u79f0\u3002 \u5982\u7b14\u8005\u7684Ray\u96c6\u7fa4\u540d\u79f0\u4e3akuberay-tdhrtg\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u6307\u4ee4\u66ff\u6362\u4e3asudo kubectl config set-context --current --namespace=kuberay-tdhrtg ```bash sudo kubectl config set-context --current --namespace={$Ray\u96c6\u7fa4\u540d\u79f0} \u5728\u672c\u5730\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002\u5bf9\u5e94 Ray\u5b98\u65b9\u6559\u7a0b \u4eceStep 3\u4e4b\u540e\u7684\u90e8\u5206\u3002 ``bash kubectl apply -f https://raw.githubusercontent.com/ray-project/kuberay/master/ray-operator/config/samples/ray-service.stable-diffusion.yaml kubectl get pods # Wait until the RayService Ready condition is True`. This means the RayService is ready to serve. kubectl describe rayservices.ray.io stable-diffusion # Forward the port of Serve kubectl port-forward svc/stable-diffusion-serve-svc 8000 # Download stable_diffusion_req.py curl -LO https://raw.githubusercontent.com/ray-project/serve_config_examples/master/stable_diffusion/stable_diffusion_req.py # Set your prompt in stable_diffusion_req.py . # Send a request to the Stable Diffusion model. python stable_diffusion_req.py ``` kubectl apply\u90e8\u7f72Stable Diffusion\u7ea6\u9700\u898115\u5206\u949f\u3002 3. \u8fd0\u884cpython stable_diffusion_req.py\u540e\uff0c\u6a21\u578b\u4f1a\u8f93\u51fa\u4e00\u5f20\u540d\u4e3aoutput.png\u7684\u56fe\u7247\u3002\u6b64\u65f6\uff0cStable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5b8c\u6210\u3002 output.png\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u66f4\u591a\u4fe1\u606f Ray\u5b98\u7f51 Ray\u5355\u673a\u7248\u5f00\u6e90\u5e93 Ray\u96c6\u7fa4\u7248\u5f00\u6e90\u5e93 Ray QuickStart\u5e2e\u52a9\u6587\u6863 Ray \u6a21\u578b\u670d\u52a1\u5316\u793a\u4f8b\u6587\u6863","title":"30\u5206\u949f\u62c9\u8d77Ray\u96c6\u7fa4\u5e76\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1"},{"location":"index-opendoc/#30raystable-diffusion","text":"","title":"30\u5206\u949f\u62c9\u8d77Ray\u96c6\u7fa4\u5e76\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1"},{"location":"index-opendoc/#ray","text":"Ray \u662f\u4e00\u4e2a\u652f\u6301\u6a21\u578b\u8bad\u7ec3\u3001\u6d4b\u8bd5\u4ee5\u53ca\u90e8\u7f72\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u7531\u52a0\u5dde\u5927\u5b66\u4f2f\u514b\u5229\u5206\u6821\u7684 RISELab \u5f00\u53d1\u3002\u5b83\u65e8\u5728\u7b80\u5316\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u3001\u5f3a\u5316\u5b66\u4e60\u548c\u5206\u5e03\u5f0f\u8ba1\u7b97\u4efb\u52a1\u7684\u5f00\u53d1\u4e0e\u90e8\u7f72\u3002Ray \u7684\u8bbe\u8ba1\u76ee\u6807\u662f\u63d0\u4f9b\u9ad8\u6027\u80fd\u3001\u7075\u6d3b\u6027\u548c\u6613\u7528\u6027\uff0c\u4f7f\u5f00\u53d1\u8005\u80fd\u591f\u8f7b\u677e\u6784\u5efa\u548c\u6269\u5c55\u590d\u6742\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u65e0\u8bba\u662f\u5904\u7406\u6d77\u91cf\u6570\u636e\u3001\u8bad\u7ec3\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\uff0c\u8fd8\u662f\u8fd0\u884c\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\uff0cRay \u90fd\u80fd\u63d0\u4f9b\u5f3a\u5927\u7684\u652f\u6301\u3002 Ray\u63d0\u4f9b\u4e86\u5927\u91cf\u7684 \u5e2e\u52a9\u6587\u6863 \uff0c\u5176\u4e2d\u5305\u542b\u8bb8\u591a\u793a\u4f8b\u548c\u6559\u7a0b\uff0c\u5e2e\u52a9\u7528\u6237\u5feb\u901f\u638c\u63e1\u5982\u4f55\u901a\u8fc7Ray\u8fdb\u884c\u6a21\u578b\u8bad\u7ec3\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002 \u8fd8\u63d0\u4f9b\u4e86\u5927\u91cf\u9002\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u4e2d\u7684 \u6a21\u578b\u670d\u52a1\u5316\u7684\u4f8b\u5b50 \uff0c\u6d89\u53ca\u5927\u8bed\u8a00\u6a21\u578b\uff0c\u5f3a\u5316\u5b66\u4e60\uff0c\u673a\u5668\u5b66\u4e60\u6a21\u578b, \u56fe\u50cf\u751f\u6210\uff08Stable Diffusion\uff09\uff0c\u56fe\u50cf\u5206\u7c7b\uff0c\u6587\u672c\u5206\u7c7b\u548c\u76ee\u6807\u68c0\u6d4b\u7b49\u4f17\u591a\u9886\u57df\u548c\u65b9\u5411\uff0c \u5e2e\u52a9\u6a21\u578b\u5f00\u53d1\u8005\u80fd\u591f\u5feb\u901f\u901a\u8fc7Ray\u6784\u5efa\u548c\u90e8\u7f72\u6a21\u578b\u670d\u52a1\u3002","title":"Ray \u5e73\u53f0\u7b80\u4ecb"},{"location":"index-opendoc/#ray_1","text":"","title":"Ray \u7684\u6838\u5fc3\u80fd\u529b"},{"location":"index-opendoc/#1","text":"\u5206\u5e03\u5f0f\u8bad\u7ec3 \uff1aRay \u63d0\u4f9b\u4e86\u5206\u5e03\u5f0f\u8bad\u7ec3\u7684\u80fd\u529b\uff0c\u652f\u6301\u591a\u673a\u591a\u5361\u7684\u6a21\u578b\u8bad\u7ec3\uff0c\u663e\u8457\u7f29\u77ed\u8bad\u7ec3\u65f6\u95f4\u3002 \u5e76\u884c\u4efb\u52a1\u6267\u884c \uff1aRay \u652f\u6301\u5c06\u4efb\u52a1\u5206\u89e3\u4e3a\u591a\u4e2a\u5b50\u4efb\u52a1\uff0c\u5e76\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u5e76\u884c\u6267\u884c\uff0c\u4ece\u800c\u9ad8\u6548\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u548c\u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1\u3002 \u52a8\u6001\u4efb\u52a1\u8c03\u5ea6 \uff1aRay \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7075\u6d3b\u7684\u4efb\u52a1\u8c03\u5ea6\u5668\uff0c\u53ef\u4ee5\u6839\u636e\u8d44\u6e90\u9700\u6c42\u52a8\u6001\u5206\u914d\u8ba1\u7b97\u8d44\u6e90\uff0c\u4f18\u5316\u4efb\u52a1\u6267\u884c\u6548\u7387\u3002 \u5bb9\u9519\u673a\u5236 \uff1a\u5185\u7f6e\u7684\u5bb9\u9519\u673a\u5236\u80fd\u591f\u5728\u8282\u70b9\u6545\u969c\u65f6\u81ea\u52a8\u6062\u590d\u4efb\u52a1\uff0c\u786e\u4fdd\u7cfb\u7edf\u7684\u9ad8\u53ef\u7528\u6027\u3002","title":"1. \u5206\u5e03\u5f0f\u8ba1\u7b97"},{"location":"index-opendoc/#2","text":"\u652f\u6301\u4e3b\u6d41\u673a\u5668\u5b66\u4e60\u6846\u67b6 \uff1aRay \u53ef\u4ee5\u4e0e TensorFlow\u3001PyTorch \u7b49\u4e3b\u6d41\u673a\u5668\u5b66\u4e60\u6846\u67b6\u65e0\u7f1d\u96c6\u6210\uff0c\u52a0\u901f\u6a21\u578b\u8bad\u7ec3\u548c\u63a8\u7406\u3002 \u652f\u6301\u5f3a\u5316\u5b66\u4e60 \uff1aRay \u96c6\u6210\u4e86 RLlib\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5f3a\u5316\u5b66\u4e60\u5e93\uff0c\u652f\u6301\u591a\u79cd\u7b97\u6cd5\uff08\u5982 DQN\u3001PPO\u3001A3C \u7b49\uff09\uff0c\u9002\u7528\u4e8e\u5404\u79cd\u5f3a\u5316\u5b66\u4e60\u573a\u666f\u3002 \u9ad8\u6548\u4eff\u771f\u73af\u5883 \uff1aRay \u53ef\u4ee5\u4e0e\u4eff\u771f\u73af\u5883\uff08\u5982 OpenAI Gym\uff09\u7ed3\u5408\uff0c\u5feb\u901f\u6784\u5efa\u548c\u6d4b\u8bd5\u5f3a\u5316\u5b66\u4e60\u6a21\u578b\u3002 \u8d85\u53c2\u6570\u8c03\u4f18 \uff1a\u901a\u8fc7 Ray Tune\uff08Ray \u7684\u8d85\u53c2\u6570\u4f18\u5316\u5e93\uff09\uff0c\u7528\u6237\u53ef\u4ee5\u9ad8\u6548\u5730\u8fdb\u884c\u8d85\u53c2\u6570\u641c\u7d22\uff0c\u627e\u5230\u6700\u4f18\u6a21\u578b\u914d\u7f6e\u3002","title":"2. \u6a21\u578b\u8bad\u7ec3\u548c\u6d4b\u8bd5"},{"location":"index-opendoc/#3","text":"Ray Serve \uff1aRay \u63d0\u4f9b\u4e86\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u670d\u52a1\u7f16\u6392\u6846\u67b6\uff08Ray Serve\uff09\uff0c\u7528\u4e8e\u90e8\u7f72\u548c\u7ba1\u7406\u673a\u5668\u5b66\u4e60\u6a21\u578b\u548c\u670d\u52a1\u3002\u5b83\u652f\u6301\u591a\u6a21\u578b\u7ec4\u5408\u3001\u52a8\u6001\u6269\u5c55\u548c\u4f4e\u5ef6\u8fdf\u63a8\u7406\u3002 \u5b9e\u65f6\u63a8\u7406 \uff1aRay Serve \u80fd\u591f\u5904\u7406\u9ad8\u5e76\u53d1\u7684\u5b9e\u65f6\u63a8\u7406\u8bf7\u6c42\uff0c\u9002\u5408\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u6a21\u578b\u670d\u52a1\u5316\u3002","title":"3. \u670d\u52a1\u7f16\u6392\u4e0e\u90e8\u7f72"},{"location":"index-opendoc/#4","text":"Ray Data \uff1aRay \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5206\u5e03\u5f0f\u6570\u636e\u5904\u7406\u5e93\uff08Ray Data\uff09\uff0c\u7528\u4e8e\u9ad8\u6548\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u96c6\u3002\u5b83\u652f\u6301\u5e38\u89c1\u7684\u6570\u636e\u64cd\u4f5c\uff08\u5982\u8fc7\u6ee4\u3001\u6620\u5c04\u3001\u805a\u5408\u7b49\uff09\uff0c\u5e76\u80fd\u4e0e\u5176\u4ed6 Ray \u7ec4\u4ef6\u65e0\u7f1d\u96c6\u6210\u3002 \u4e0e\u5927\u6570\u636e\u751f\u6001\u517c\u5bb9 \uff1aRay \u53ef\u4ee5\u4e0e Apache Spark \u7b49\u5927\u6570\u636e\u5de5\u5177\u7ed3\u5408\u4f7f\u7528\uff0c\u8fdb\u4e00\u6b65\u6269\u5c55\u5176\u6570\u636e\u5904\u7406\u80fd\u529b\u3002","title":"4. \u5927\u89c4\u6a21\u6570\u636e\u5904\u7406"},{"location":"index-opendoc/#ray_2","text":"\u901a\u8fc7\u4ee5\u4e0a\u4ecb\u7ecd\u53ef\u4ee5\u770b\u51fa\uff0cRay \u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u4e14\u7075\u6d3b\u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\u5e73\u53f0\uff0c\u9002\u7528\u4e8e\u4ece\u673a\u5668\u5b66\u4e60\u5230\u79d1\u5b66\u8ba1\u7b97\u7684\u5e7f\u6cdb\u573a\u666f\u3002\u5b83\u7684\u9ad8\u6027\u80fd\u3001\u6613\u7528\u6027\u548c\u4e30\u5bcc\u7684\u751f\u6001\u7cfb\u7edf\u4f7f\u5176\u6210\u4e3a\u5f00\u53d1\u8005\u7684\u9996\u9009\u5de5\u5177\u4e4b\u4e00\u3002 \u90a3\u4e48\uff0c\u8be5\u5982\u4f55\u90e8\u7f72\u548c\u4f7f\u7528 Ray \u5462\uff1f","title":"Ray \u7684\u90e8\u7f72\u65b9\u5f0f"},{"location":"index-opendoc/#_1","text":"Ray\u652f\u6301\u5728\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u7684 \u672c\u5730\u90e8\u7f72 \uff0c\u4e14\u63d0\u4f9b\u4e86python\u3001Java\u3001C++\u4ee5\u53caDocker\u7b49\u60c5\u51b5\u4e0b\u7684\u5b89\u88c5\u65b9\u5f0f\u3002","title":"\u672c\u5730\u5355\u673a\u90e8\u7f72"},{"location":"index-opendoc/#_2","text":"\u524d\u63d0\u6761\u4ef6\uff1a \u7528\u6237\u5df2\u6709k8s\u96c6\u7fa4\u6216\u53ef\u81ea\u884c\u521b\u5efak8s\u96c6\u7fa4\u3002 \u7531\u4e8e\u5355\u673a\u573a\u666f\u4e0b\u6027\u80fd\u6709\u9650\uff0c\u96be\u4ee5\u652f\u6301\u751f\u4ea7\u573a\u666f\u4e0b\u7684\u6a21\u578b\u8bad\u7ec3\uff0cRay\u8fd8\u63d0\u4f9b\u4e86\u5f00\u6e90\u7684\u96c6\u7fa4\u7248\u672c\uff1a KubeRay \u3002 \u7528\u6237\u53ef\u6839\u636e RayCluster Quickstart \u6d41\u7a0b\u90e8\u7f72KubeRay\uff0c \u53ef\u6839\u636e RayJob Quickstart \u4f53\u9a8c\u5982\u4f55\u901a\u8fc7KubeRay\u7ba1\u7406\u4efb\u52a1\uff0c \u8fd8\u53ef\u6839\u636e RayService Quickstart \u4f53\u9a8c\u5982\u4f55\u901a\u8fc7KubeRay\u90e8\u7f72\u7528\u6237\u5e94\u7528\u3002 \u4ed3\u5e93\u4e2d\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u793a\u4f8b\u5e94\u7528\uff0c\u5e2e\u52a9\u7528\u6237\u5feb\u901f\u4e86\u89e3KubeRay\u4e0b\u7684\u6a21\u578b\u90e8\u7f72\u8fc7\u7a0b\u3002","title":"\u672c\u5730\u96c6\u7fa4\u90e8\u7f72"},{"location":"index-opendoc/#_3","text":"\u524d\u63d0\u6761\u4ef6\uff1a \u5f00\u901a\u963f\u91cc\u4e91\u8d26\u53f7\u3002 \u963f\u91cc\u4e91\u8ba1\u7b97\u5de2\u63d0\u4f9b\u4e86Ray\u7684\u4e00\u952e\u90e8\u7f72\u670d\u52a1\uff0c\u7528\u6237\u65e0\u9700\u624b\u52a8\u642d\u5efaRay\u96c6\u7fa4\uff0c\u4ec5\u9700\u5728\u521b\u5efa\u5b9e\u4f8b\u540e\u7b49\u5f85\u7ea610\u5206\u949f\uff0c\u5373\u53ef\u4f53\u9a8cRay\u96c6\u7fa4\u7684\u5f3a\u5927\u80fd\u529b\u3002","title":"\u963f\u91cc\u4e91\u4e00\u952e\u90e8\u7f72"},{"location":"index-opendoc/#_4","text":"\u70b9\u51fb Ray\u4e00\u952e\u90e8\u7f72 \u94fe\u63a5\uff0c \u8fdb\u5165\u521b\u5efaRay\u96c6\u7fa4\u7684\u9875\u9762\u3002\u5982\u6ca1\u6709\u963f\u91cc\u4e91\u8d26\u53f7\u9700\u8981\u5148\u6ce8\u518c\u8d26\u53f7\u54e6\u3002 \u521b\u5efaRay\u96c6\u7fa4\u65f6\uff0c\u9996\u5148\u9009\u62e9\u65b0\u5efaACK\u96c6\u7fa4\u3002\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0\u5c06\u4f5c\u4e3a\u8fd0\u884cRay\u5e73\u53f0\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5c06\u5728\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u65f6\u4f7f\u7528\u3002 \u4e3a\u4fdd\u969cRay\u7684\u6d41\u7545\u8fd0\u884c\uff0cWorker\u8282\u70b9\u5efa\u8bae\u9009\u62e9 8vCpu 16GiB \u4ee5\u4e0a\u7684\u89c4\u683c\u3002\u7136\u540e\u586b\u5199\u5b9e\u4f8b\u5bc6\u7801\u3002 \u6a21\u578b\u90e8\u7f72\u57fa\u672c\u90fd\u6709Gpu\u9700\u6c42\uff0c\u5982\u679c\u9700\u8981Gpu\uff0c\u8bf7\u5728\u6b64\u6b65\u9009\u62e9\u6709Gpu\u7684\u89c4\u683c\u3002 \u672c\u6587\u6863\u5728\u4e0b\u4e00\u8282\u6f14\u793a\u4e86\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002 \u9009\u62e9\u4efb\u610f\u4e00\u4e2a\u53ef\u7528\u533a\uff0c\u7136\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65\uff1a\u786e\u8ba4\u8ba2\u5355\u3002 \u786e\u8ba4\u4f9d\u8d56\u6743\u9650\u5df2\u6388\u6743\uff0c\u5982\u672a\u6388\u6743\uff0c\u8bf7\u70b9\u51fb\u6388\u6743\u3002\u7136\u540e\u70b9\u51fb \u7acb\u5373\u521b\u5efa \u70b9\u51fb \u53bb\u5217\u8868\u67e5\u770b \u8df3\u8f6c\u5230\u8ba1\u7b97\u5de2\u63a7\u5236\u53f0\u7684\u670d\u52a1\u5b9e\u4f8b\u754c\u9762\u540e\uff0c\u8bf7\u7b49\u5f85Ray\u96c6\u7fa4\u521b\u5efa\u5b8c\u6210\uff0c\u5927\u7ea6\u9700\u898110\u5206\u949f\u3002 \u521b\u5efaRay\u96c6\u7fa4\u5b8c\u6210\u540e\uff0c\u70b9\u51fb Ray\u96c6\u7fa4\u540d\u79f0\u8fdb\u5165Ray\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u900f\u51fa\u7684web url\uff0c\u5373\u53ef\u8bbf\u95ee\u5230Ray\u96c6\u7fa4\u7684Ray Dashboard\u3002\u6b64\u65f6Ray\u96c6\u7fa4\u5df2\u7ecf\u6210\u529f\u8fd0\u884c\uff0c\u53ef\u901a\u8fc7 \u4e0b\u4e00\u8282\uff1a\u5feb\u901f\u4f53\u9a8c\u6a21\u578b\u90e8\u7f72 \u4e86\u89e3\u5982\u4f55\u5728\u96c6\u7fa4\u5185\u90e8\u7f72\u81ea\u5df1\u7684\u6a21\u578b\u3002","title":"\u90e8\u7f72\u6d41\u7a0b"},{"location":"index-opendoc/#_5","text":"\u901a\u8fc7\u963f\u91cc\u4e91\u521b\u5efaRay\u96c6\u7fa4\u540e\uff0c\u672c\u8282\u5c55\u793a\u5982\u4f55\u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72\u4e00\u4e2a\u57fa\u4e8e Stable Diffusion \u7684\u6587\u672c\u5230\u56fe\u50cf\u751f\u6210\u670d\u52a1\u3002\u66f4\u591a\u793a\u4f8b\u53ef\u53c2\u8003[http://docs.ray.io/en/master/cluster/kubernetes/examples/stable-diffusion-rayservice.html#kuberay-stable-diffusion-rayservice-example)\u3002","title":"\u4f53\u9a8c\u6a21\u578b\u670d\u52a1\u90e8\u7f72"},{"location":"index-opendoc/#_6","text":"\u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u96c6\u7fa4\u914d\u7f6e\u4e0d\u591f\u7528\uff0c\u4f1a\u5bfc\u81f4Stable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5931\u8d25\u3002 1. \u5728Ray\u96c6\u7fa4\u4e0a\u90e8\u7f72Stable Diffusion\u6a21\u578b\u670d\u52a1\uff0c\u63a8\u8350\u4f7f\u7528ecs.gn7i-c8g1.2xlarge\u53ca\u4ee5\u4e0a\u89c4\u683c\uff0cworker\u8282\u70b9\u7cfb\u7edf\u76d8\u5927\u5c0f\u63a8\u83501024GB\u4ee5\u4e0a\u3002","title":"\u786e\u8ba4\u96c6\u7fa4\u914d\u7f6e\u8db3\u591f"},{"location":"index-opendoc/#ip","text":"\u26a0\ufe0f\u6ce8\u610f\uff1a \u5982\u679c\u4e0d\u7ed1\u5b9a\u516c\u7f51IP\uff0c\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u62c9\u53d6\u6a21\u578b\u6587\u4ef6\u5931\u8d25\uff0c\u4e5f\u4f1a\u5bfc\u81f4Ray\u96c6\u7fa4\u65e0\u6cd5\u63d0\u4f9b\u5bf9\u5916\u670d\u52a1\u3002 1. \u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 2. \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 3. \u70b9\u51fb \u7ed1\u5b9a\u516c\u7f51IP \uff0c\u9009\u62e9\u5df2\u6709EIP\u3002\u5982\u679c\u6ca1\u6709EIP\uff0c\u70b9\u51fb\u521b\u5efaEIP\uff0c\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u8fd4\u56de\u8be5\u9875\u9762\u7ed1\u5b9a\u516c\u7f51IP\u3002","title":"\u96c6\u7fa4\u7ed1\u5b9a\u516c\u7f51IP(\u5982\u679c\u5df2\u7ed1\u5b9a\u53ef\u8df3\u8fc7)"},{"location":"index-opendoc/#kubectl-kubernetes","text":"\u5728\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u70b9\u51fb \u8d44\u6e90 \uff0c\u67e5\u770bRay\u96c6\u7fa4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002 \u627e\u5230k8s\u96c6\u7fa4\uff0c\u70b9\u51fb\u540d\u79f0\u8fdb\u5165k8s\u96c6\u7fa4\u8be6\u60c5\u9875\u9762\u3002 \u70b9\u51fb\u8fde\u63a5\u4fe1\u606f\uff0c\u67e5\u770bkubeconfig\u6587\u4ef6\u3002 \u70b9\u51fb \u5b89\u88c5\u548c\u8bbe\u7f6e kubectl \u3002\u8fd9\u662f\u4e00\u4e2a\u7528\u672c\u5730\u8bbe\u5907\u7ba1\u7406k8s\u96c6\u7fa4\u7684\u5de5\u5177\u3002\u53ef\u6839\u636e\u81ea\u8eab\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u5bf9\u5e94\u7684\u5b89\u88c5\u65b9\u5f0f\u3002 \u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6216\u81ea\u884c\u5728\u76ee\u5f55\u8def\u5f84\u4e0b\u624b\u52a8\u521b\u5efa$HOME/.kube/config\u6587\u4ef6\uff0c\u5e76\u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u3002 ```bash sudo mkdir -p $HOME/.kube sudo touch $HOME/.kube/config sudo chmod 777 $HOME/.kube/config vim $HOME/.kube/config","title":"\u901a\u8fc7 kubectl \u8fde\u63a5 Kubernetes \u96c6\u7fa4"},{"location":"index-opendoc/#_7","text":"\u5c06kubeconfig\u6587\u4ef6\u5185\u5bb9\u7c98\u8d34\u5230\u8be5\u6587\u4ef6\u4e2d\u540e\uff0c\u5728\u672c\u5730\u8bbe\u5907\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002--namespace={$\u670d\u52a1\u5b9e\u4f8b\u540d\u79f0}\uff0c\u9700\u8981\u66ff\u6362\u4e3aRay\u96c6\u7fa4\u540d\u79f0\u3002 \u5982\u7b14\u8005\u7684Ray\u96c6\u7fa4\u540d\u79f0\u4e3akuberay-tdhrtg\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u6307\u4ee4\u66ff\u6362\u4e3asudo kubectl config set-context --current --namespace=kuberay-tdhrtg ```bash sudo kubectl config set-context --current --namespace={$Ray\u96c6\u7fa4\u540d\u79f0} \u5728\u672c\u5730\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002\u5bf9\u5e94 Ray\u5b98\u65b9\u6559\u7a0b \u4eceStep 3\u4e4b\u540e\u7684\u90e8\u5206\u3002 ``bash kubectl apply -f https://raw.githubusercontent.com/ray-project/kuberay/master/ray-operator/config/samples/ray-service.stable-diffusion.yaml kubectl get pods # Wait until the RayService Ready condition is True`. This means the RayService is ready to serve. kubectl describe rayservices.ray.io stable-diffusion # Forward the port of Serve kubectl port-forward svc/stable-diffusion-serve-svc 8000 # Download stable_diffusion_req.py curl -LO https://raw.githubusercontent.com/ray-project/serve_config_examples/master/stable_diffusion/stable_diffusion_req.py # Set your prompt in stable_diffusion_req.py . # Send a request to the Stable Diffusion model. python stable_diffusion_req.py ``` kubectl apply\u90e8\u7f72Stable Diffusion\u7ea6\u9700\u898115\u5206\u949f\u3002 3. \u8fd0\u884cpython stable_diffusion_req.py\u540e\uff0c\u6a21\u578b\u4f1a\u8f93\u51fa\u4e00\u5f20\u540d\u4e3aoutput.png\u7684\u56fe\u7247\u3002\u6b64\u65f6\uff0cStable Diffusion\u6a21\u578b\u670d\u52a1\u90e8\u7f72\u5b8c\u6210\u3002 output.png\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"\u90e8\u7f72\u6a21\u578b\u670d\u52a1"},{"location":"index-opendoc/#_8","text":"Ray\u5b98\u7f51 Ray\u5355\u673a\u7248\u5f00\u6e90\u5e93 Ray\u96c6\u7fa4\u7248\u5f00\u6e90\u5e93 Ray QuickStart\u5e2e\u52a9\u6587\u6863 Ray \u6a21\u578b\u670d\u52a1\u5316\u793a\u4f8b\u6587\u6863","title":"\u66f4\u591a\u4fe1\u606f"}]}